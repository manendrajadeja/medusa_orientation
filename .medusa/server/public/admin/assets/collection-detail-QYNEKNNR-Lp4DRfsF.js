import{u as N}from"./chunk-BW322BVH-CQe5ZHFg.js";import{e as q,ag as I,ej as b,a as z,j as a,ek as M,s as B,el as F,q as G,b as p,h as g,u as H,d as L,eh as O,C as f,H as S,A as x,P as C,T as P,a4 as j,f as Q,em as w,an as W,r as $,g as Y,a3 as v,k as J,t as u}from"./index-B4t95BeZ.js";import{u as K,_ as U}from"./chunk-DTZXEQXZ-DpkkthMZ.js";import{u as Z,a as V}from"./chunk-R65S6ZZV-CfYVbgNw.js";import"./chunk-ZQJPHZKI-CDvkx_I9.js";import{S as X}from"./chunk-GIZFNLKK-D939cf9Z.js";import{G as ee}from"./globe-europe-C3I9UIaX.js";import"./chunk-XLDQPLK4-ZnS2NNzp.js";import"./chunk-ADOCJB6L-BpeR2Dvl.js";import"./chunk-P3UUX2T6-BU36g5QR.js";import"./chunk-IQBAUTU5-DLAlE4e0.js";import"./chunk-HQKGZADC-El4zu_Cj.js";import"./chunk-EMIHDNB7-CYj0gs5H.js";import"./chunk-C76H5USB-BFPKvQ1Z.js";import"./chunk-DFFLVEZ5-BqvsHDMn.js";import"./index-C2aMyV2D.js";import"./Trans-McF8dLDR.js";var Pe=t=>{const{id:e}=t.params||{},{collection:s}=b(e,{initialData:t.data,enabled:!!e});return s?a.jsx("span",{children:s.title}):null},te=({collection:t})=>{const{t:e}=p(),s=g(),o=H(),n=L("translation"),{mutateAsync:r}=O(t.id),i=async()=>{await s({title:e("general.areYouSure"),description:e("collections.deleteWarning",{count:1,title:t.title})})&&(await r(),o("../",{replace:!0}))};return a.jsxs(f,{className:"divide-y p-0",children:[a.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[a.jsx(S,{children:t.title}),a.jsx(x,{groups:[{actions:[{icon:a.jsx(C,{}),label:e("actions.edit"),to:`/collections/${t.id}/edit`,disabled:!t.id}]},...n?[{actions:[{label:e("translations.actions.manage"),to:`/settings/translations/edit?reference=product_collection&reference_id=${t.id}`,icon:a.jsx(ee,{})}]}]:[],{actions:[{icon:a.jsx(P,{}),label:e("actions.delete"),onClick:i,disabled:!t.id}]}]})]}),a.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center px-6 py-4",children:[a.jsx(j,{size:"small",leading:"compact",weight:"plus",children:e("fields.handle")}),a.jsxs(j,{size:"small",children:["/",t.handle]})]})]})},d=10,se=({collection:t})=>{const{t:e}=p(),{searchParams:s,raw:o}=Z({pageSize:d}),{products:n,count:r,isLoading:i,isError:l,error:k}=Q({limit:d,...s,collection_id:[t.id]},{placeholderData:J}),T=V(["collections"]),h=oe(),{table:D}=K({data:n??[],columns:h,getRowId:c=>c.id,count:r,enablePagination:!0,enableRowSelection:!0,pageSize:d,meta:{collectionId:t.id}}),A=g(),{mutateAsync:E}=w(t.id),R=async c=>{const m=Object.keys(c);await A({title:e("general.areYouSure"),description:e("collections.removeProductsWarning",{count:m.length}),confirmText:e("actions.remove"),cancelText:e("actions.cancel")})&&await E({remove:m},{onSuccess:()=>{u.success(e("collections.products.remove.successToast",{count:m.length}))},onError:_=>{u.error(_.message)}})};if(l)throw k;return a.jsxs(f,{className:"divide-y p-0",children:[a.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[a.jsx(S,{level:"h2",children:e("products.domain")}),a.jsx(x,{groups:[{actions:[{icon:a.jsx(W,{}),label:e("actions.add"),to:"products"}]}]})]}),a.jsx(U,{table:D,columns:h,search:!0,pagination:!0,pageSize:d,navigateTo:({original:c})=>`/products/${c.id}`,count:r,filters:T,isLoading:i,orderBy:[{key:"title",label:e("fields.title")},{key:"created_at",label:e("fields.createdAt")},{key:"updated_at",label:e("fields.updatedAt")}],queryObject:o,commands:[{action:R,label:e("actions.remove"),shortcut:"r"}],noRecords:{message:e("collections.products.list.noRecordsMessage")}})]})},ae=({product:t,collectionId:e})=>{const{t:s}=p(),o=g(),{mutateAsync:n}=w(e),r=async()=>{await o({title:s("general.areYouSure"),description:s("collections.removeSingleProductWarning",{title:t.title}),confirmText:s("actions.remove"),cancelText:s("actions.cancel")})&&await n({remove:[t.id]},{onSuccess:()=>{u.success(s("collections.products.remove.successToast",{count:1}))},onError:l=>{u.error(l.message)}})};return a.jsx(x,{groups:[{actions:[{icon:a.jsx(C,{}),label:s("actions.edit"),to:`/products/${t.id}/edit`}]},{actions:[{icon:a.jsx(P,{}),label:s("actions.remove"),onClick:r}]}]})},y=Y(),oe=()=>{const t=N();return $.useMemo(()=>[y.display({id:"select",header:({table:e})=>a.jsx(v,{checked:e.getIsSomePageRowsSelected()?"indeterminate":e.getIsAllPageRowsSelected(),onCheckedChange:s=>e.toggleAllPageRowsSelected(!!s)}),cell:({row:e})=>a.jsx(v,{checked:e.getIsSelected(),onCheckedChange:s=>e.toggleSelected(!!s),onClick:s=>{s.stopPropagation()}})}),...t,y.display({id:"actions",cell:({row:e,table:s})=>{const{collectionId:o}=s.options.meta;return a.jsx(ae,{product:e.original,collectionId:o})}})],[t])},we=()=>{const t=q(),{id:e}=I(),{collection:s,isLoading:o,isError:n,error:r}=b(e,{initialData:t}),{getWidgets:i}=z();if(o||!s)return a.jsx(M,{sections:2,showJSON:!0,showMetadata:!0});if(n)throw r;return a.jsxs(X,{widgets:{after:i("product_collection.details.after"),before:i("product_collection.details.before")},showJSON:!0,showMetadata:!0,data:s,children:[a.jsx(te,{collection:s}),a.jsx(se,{collection:s})]})},re=t=>({queryKey:F.detail(t),queryFn:async()=>B.admin.productCollection.retrieve(t)}),ke=async({params:t})=>{const e=t.id,s=re(e);return G.ensureQueryData(s)};export{Pe as Breadcrumb,we as Component,ke as loader};
